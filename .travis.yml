language: go
dist: xenial
sudo: true
matrix:
  include:
  - os: linux
    env:
    - GOOS=linux
    - GOARCH=amd64
    - HOST_OS=linux
    go: '1.14'
  - os: linux
    env:
    - GOOS=linux
    - GOARCH=386
    - HOST_OS=linux
    go: '1.14'
  - os: linux
    env:
    - GOOS=linux
    - GOARCH=arm64
    - HOST_OS=linux
    go: '1.14'
  - os: linux
    env:
    - GOOS=linux
    - GOARCH=arm
    - HOST_OS=linux
    go: '1.14'
  - os: linux
    env:
    - GOOS=windows
    - GOARCH=amd64
    - HOST_OS=linux
    go: '1.14'
  - os: linux
    env:
    - GOOS=windows
    - GOARCH=386
    - HOST_OS=linux
    go: '1.14'
  - os: osx
    env:
    - GOOS=darwin
    - GOARCH=amd64
    - HOST_OS=darwin
    go: '1.14'
before_install:
- git fetch --tags
- GOARCH=amd64 GOOS=$HOSTOS go get golang.org/x/tools/cmd/stringer
- GOARCH=amd64 GOOS=$HOSTOS go get github.com/mattn/goveralls
- GOARCH=amd64 GOOS=$HOSTOS go get github.com/GeertJohan/go.rice/rice
script:
- go get ./...
- "./ci/test.sh"
- GOARCH=amd64 GOOS=$HOSTOS make vue_production
- GOARCH=amd64 GOOS=$HOSTOS make generate
- make dist
before_deploy:
- "./ci/pack.sh"
deploy:
  provider: releases
  api_key:
    secure: E1dPDLansDlCEOMudhDjlMVtRnP7jBR/5ltqlRlxuhZBe0Y+IiiuzybbG8XI1g9REKPZYJuHkwftKQxCumQpRu4gwUKgeVEE+A3L7uItWfiGi1LQ49SzLfWvGD6mLX6IILyhKgHhiNxGH7le6QiZjEr1xbexFTXs4AVQ/poS21hD9Kz/eY4wlU1hNZQOV0buLd5gx4QqGIXAo5j1QoN5+wbRajF+0tDuU9F7gGPWVXPOxOYm5JaanTRmQWVaoNjYuglxlltLtaKdwuOSorfq3oQ/qIvZosbJZ5wr96FLCnOOdcG/7bR4fEQZcr5IIAVl3vj3p5XGQ92qVVEvgyqWDXVUbRHk5WF1zKa76VQJ9/C+DjkWE1Gj5S03Ai1/G0hrBPbUiBSFFhTrETzgjrLXwT1enmIwiwguKiHZ7W8WvgiLUpMe3vwb2UKG2aGM7V7+loqyZ74cvByKnbRK418oKNh634h9TChw7mb/2LtbEaCyoxcv1a1Wlp3LZsvc+BwZEB2IyX9M/sG7+NxFLOaaep8T+tlMLdUXF8pkrQJ8n6gzQpLvuZ3zVWxBXujE1bhQx7WOGx5IUq9K2f6EWue3Vff1GJQs39Xc7NFNkO2LXJRLrC/TLczmyT02S5OWFYyW2U9U7TL/+pt/mV9WxKnMUDQ7cb/CbmaI5FyfkdnJyT4=
  file: remoteSwitch-$TRAVIS_TAG-$GOOS-$GOARCH.*
  skip_cleanup: true
  on:
    repo: dh1tw/remoteSwitch
    tags: true
    draft: true